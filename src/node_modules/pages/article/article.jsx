import React, {useEffect} from 'react';
import useFetch from 'hooks/useFetch';
import {Link} from 'react-router-dom';
import TagList from 'components/tagList';
import Loading from 'components/Loading';
import ErrorMessage from 'components/ErrorMessage';

const Article = (props) => {

    const slug = props.match.params.slug;
    const urlUSer = `/articles/${slug}`;


    const [{isLoading, response, error}, doFetch] = useFetch(urlUSer);

    useEffect(() => {
        doFetch();
    }, [doFetch]);

    response && console.log('response', response);

    return <div className="article-page">

        {!isLoading && response && (
            <div className="banner">
                <div className="container">
                    <h1>{response.article.title}</h1>
                    <div className="article-meta">
                        <Link to={`profiles/${response.article.author.username}`}>
                            <img src={response.article.author.image} alt=""/>
                        </Link>
                        <div className="info">
                            <Link to={response.article.author.username}>{response.article.author.username}</Link>
                            <span className="date">{response.article.createdAt}</span>
                        </div>
                    </div>
                </div>
            </div>
        )}

        <div className="container page">
            {isLoading && <Loading/>}
            {error && <ErrorMessage/>}
            {!isLoading && response && (
                <div className="row article-content">
                    <div className="col-xs-12">
                        <p>{response.article.body}</p>
                    </div>
                    <TagList tags={response.article.tagList}></TagList>
                </div>
            )}
        </div>
    </div>;

};

export default Article;