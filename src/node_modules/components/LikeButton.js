import React from 'react'
import classNames from 'classnames';
import useFetch from 'hooks/useFetch'

const LikeButton = ({favorite, likesCount, articleSlug}) => {
    const apiUrl = `/articles/${articleSlug}/favorite`
    const [{response}, doFetch] = useFetch(apiUrl)

    const favoritesCount = response ?
        response.article.favoritesCount :
        likesCount

    const isFavoriteClicked = response ?
        response.article.favorited :
        favorite

    const handleLike =(e)=>{
        e.preventDefault()
        doFetch({
            method : isFavoriteClicked ? 'delete' : 'post'
        })
    }


    const buttonClasses = classNames({
        btn: true,
        "btn-sm": true,
        "btn-primary": isFavoriteClicked,
        "btn-outline-primary": !isFavoriteClicked

    })

    return <button className={buttonClasses} onClick={handleLike}>
        <i className="ion-heart"></i>

        <span>  &nbsp;
            {favoritesCount}</span>
    </button>
}

export default LikeButton